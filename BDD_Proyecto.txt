CREATE DATABASE proyectoDSS;

USE proyectoDSS;


CREATE TABLE Tipo_Movimiento (
`Cod_movimiento` int NOT NULL AUTO_INCREMENT,
`Nombre` varchar(15) NOT NULL,

PRIMARY KEY (`Cod_movimiento`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


CREATE TABLE Clientes(
`DUI` char (10) NOT NULL ,
`nombre` varchar(50) NOT NULL,
`apellido` varchar(50) NOT NULL,
`usuario` varchar(25) NOT NULL,
`contraseña` varchar(25) NOT NULL,
`Correo_Electronico` varchar(50) NOT NULL,

PRIMARY KEY (`DUI`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;



CREATE TABLE Cuentas(
`Num_cuenta` int NOT NULL,
`Cod_Cliente` char (10) NOT NULL,
`Saldo_disponible` decimal (15,2) NOT NULL,

PRIMARY KEY (`Num_cuenta`),
KEY `Cod_Cliente` (`Cod_Cliente`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;




CREATE TABLE Movimientos_Bancarios(
`Cod_movimentos_Banca` int NOT NULL AUTO_INCREMENT,
`Cod_TipoMovimiento` int NOT NULL,
`NumCuenta_destino` int DEFAULT NULL,
`NumCuenta_Origen` int NOT NULL,
`Saldo_disponible` decimal (15,2) NOT NULL,
`Valor_transaccion` decimal (15,2) NOT NULL,
`Fecha_registro` date NOT NULL,
 
PRIMARY KEY (`Cod_movimentos_Banca`),
KEY `NumCuenta_destino` (`NumCuenta_destino`),
KEY `NumCuenta_Origen` (`NumCuenta_Origen`),
KEY `Cod_TipoMovimiento` (`Cod_TipoMovimiento`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;





CREATE TABLE Prestamos(
`Cod_prestamo` int NOT NULL AUTO_INCREMENT,
`Cod_estado` int NOT NULL,
`Cod_Cliente` char (10) NOT NULL,
`Sueldo_cliente` decimal (15,2) NOT NULL,
`Cuota_Apagar` decimal (15,2) NOT NULL,
`Saldo_Prestamo` decimal (15,2) NOT NULL,
`Años_plazos` int NOT NULL,
`Cod_empleado` int NOT NULL,

PRIMARY KEY (`Cod_prestamo`),
KEY `Cod_estado` (`Cod_estado`),
KEY `Cod_Cliente` (`Cod_Cliente`),
KEY `Cod_empleado` (`Cod_empleado`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;




CREATE TABLE Estado_Prestamo(
`Cod_estado` int NOT NULL AUTO_INCREMENT,
`Nombre` varchar(20) NOT NULL,

PRIMARY KEY (`Cod_estado`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


CREATE TABLE Empleados(
`Cod_empleado` int NOT NULL AUTO_INCREMENT,
`nombre` varchar(50) NOT NULL,
`apellido` varchar(50) NOT NULL,
`Cod_TipoCategoria` int NOT NULL,
`Cod_estadoEmple` int NOT NULL,
`Cod_sucursal` int NOT NULL ,
`Cod_estado` int NOT NULL,
`usuario` varchar(50) NOT NULL,
`contraseña` varchar(50) NOT NULL,

PRIMARY KEY (`Cod_empleado`),
KEY `Cod_TipoCategoria` (`Cod_TipoCategoria`),
KEY `Cod_estadoEmple` (`Cod_estadoEmple`),
KEY `Cod_sucursal` (`Cod_sucursal`),
KEY `Cod_estado` (`Cod_estado`)
 
)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


CREATE TABLE Gerentes_adminitradores(
`Cod_gerente` int NOT NULL AUTO_INCREMENT,
`nombre` varchar(50) NOT NULL,
`apellido` varchar(50) NOT NULL,
`Cod_TipoCategoria` int NOT NULL,
`usuario` varchar(50) NOT NULL,
`contraseña` varchar(50) NOT NULL,

PRIMARY KEY (`Cod_gerente`),
KEY `Cod_TipoCategoria` (`Cod_TipoCategoria`)
 
)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;



CREATE TABLE Estados_Empleado(
`Cod_estadoEmple` int NOT NULL AUTO_INCREMENT,
`Nombre` varchar(10) NOT NULL,

PRIMARY KEY (`Cod_estadoEmple`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;






-- TABLA CUENTAS


ALTER TABLE `Cuentas`
  ADD CONSTRAINT `cuenta_ibfk_1` FOREIGN KEY (`Cod_Cliente`) REFERENCES `Clientes` (`DUI`);




-- TABLA MOVIMIENTOS BANCARIOS

	
ALTER TABLE `Movimientos_Bancarios`
  ADD CONSTRAINT `Movimientos_Ban_ibfk_1` FOREIGN KEY (`NumCuenta_destino`) REFERENCES `Cuentas` (`Num_cuenta`)ON DELETE SET NULL
ON UPDATE SET NULL;

ALTER TABLE `Movimientos_Bancarios`
  ADD CONSTRAINT `Movimientos_Ban_ibfk_2` FOREIGN KEY (`NumCuenta_Origen`) REFERENCES `Cuentas` (`Num_cuenta`);

ALTER TABLE `Movimientos_Bancarios`
  ADD CONSTRAINT `Movimientos_Ban_ibfk_3` FOREIGN KEY (`Cod_TipoMovimiento`) REFERENCES `Tipo_Movimiento` (`Cod_movimiento`);




-- TABLA DE PRESTAMOS

ALTER TABLE `Prestamos`
  ADD CONSTRAINT `Prestamos_ibfk_1` FOREIGN KEY (`Cod_estado`) REFERENCES `Estado_Prestamo` (`Cod_estado`);

ALTER TABLE `Prestamos`
  ADD CONSTRAINT `Prestamos_ibfk_2` FOREIGN KEY (`Cod_Cliente`) REFERENCES `Clientes` (`DUI`);

ALTER TABLE `Prestamos`
  ADD CONSTRAINT `Prestamos_ibfk_3` FOREIGN KEY (`Cod_empleado`) REFERENCES `Empleados` (`Cod_empleado`);




-- TABLA DE EMPLEADOS

ALTER TABLE `Empleados`
  ADD CONSTRAINT `Empleados_ibfk_1` FOREIGN KEY (`Cod_TipoCategoria`) REFERENCES `Tipo_Categoria` (`Cod_Tipo`);

ALTER TABLE `Empleados`
  ADD CONSTRAINT `Empleados_ibfk_2` FOREIGN KEY (`Cod_estadoEmple`) REFERENCES `Estados_Empleado` (`Cod_estadoEmple`);

ALTER TABLE `Empleados`
  ADD CONSTRAINT `Empleados_ibfk_3` FOREIGN KEY (`Cod_sucursal`) REFERENCES `Sucursal` (`Cod_sucursal`);

ALTER TABLE `Empleados`
  ADD CONSTRAINT `Empleados_ibfk_4` FOREIGN KEY (`Cod_estado`) REFERENCES `Estado_Prestamo` (`Cod_estado`);



-- TABLA DE ADMINISTRADORES

ALTER TABLE `Gerentes_adminitradores`
  ADD CONSTRAINT `Gerentes_ibfk_1` FOREIGN KEY (`Cod_gerente`) REFERENCES `Tipo_Categoria` (`Cod_Tipo`);


-- TABLA DE SUCURSAL



INSERT INTO `Estado_Prestamo` (`Cod_estado`, `Nombre`) VALUES
(1, 'En espera'),
(2, 'Aprobado'),
(3, 'Rechazado');

INSERT INTO `Tipo_Movimiento` (`Cod_movimiento`, `Nombre`) VALUES
(1, 'Depósito'),
(2, 'Retiro'),
(3, 'Transferencia');

INSERT INTO `Tipo_Categoria` (`Cod_Tipo`, `Nombre`) VALUES
(1, 'Cajeros del banco'),
(2, 'personal de limpieza'),
(3, 'secretarias'),
(4, 'asesores financieros'),



INSERT INTO `Clientes` (`DUI`, `nombre`, `apellido`, `usuario`, `contraseña`, `Correo_Electronico`) VALUES
('06723456-6', 'Rodrigo','Vasquez','usuario1','usuario1','rodry@gmail.com');

INSERT INTO `Clientes` (`DUI`, `nombre`, `apellido`, `usuario`, `contraseña`, `Correo_Electronico`) VALUES
('06723422-1', 'Fernando','Perez','usuario2','usuario2','Perez@gmail.com');

INSERT INTO `Cuentas` (`Num_cuenta`, `Cod_Cliente`, `Saldo_disponible`) VALUES
(12345678,'06723456-6',200);

INSERT INTO `Cuentas` (`Num_cuenta`, `Cod_Cliente`, `Saldo_disponible`) VALUES
(87654321,'06723422-1',500);

